python ./code/TF_FeatureExtraction/example_feat_extract.py --network resnet_v2_152 --checkpoint /Users/hanjunx/workspace/tensorflow/checkpoints/resnet_v2_152_2017_04_14/resnet_v2_152.ckpt --image_path ./data/images_sample/train/ --out_file ./data/features_sample/train.h5 --layer_names resnet_v2_152/logits --preproc_func inception

resnet_v2_152/conv1 has shape (?, 112, 112, 64)
resnet_v2_152/block1/unit_1/bottleneck_v2/shortcut has shape (?, 56, 56, 256)
resnet_v2_152/block1/unit_1/bottleneck_v2/conv1 has shape (?, 56, 56, 64)
resnet_v2_152/block1/unit_1/bottleneck_v2/conv2 has shape (?, 56, 56, 64)
resnet_v2_152/block1/unit_1/bottleneck_v2/conv3 has shape (?, 56, 56, 256)
resnet_v2_152/block1/unit_1/bottleneck_v2 has shape (?, 56, 56, 256)
resnet_v2_152/block1/unit_2/bottleneck_v2/conv1 has shape (?, 56, 56, 64)
resnet_v2_152/block1/unit_2/bottleneck_v2/conv2 has shape (?, 56, 56, 64)
resnet_v2_152/block1/unit_2/bottleneck_v2/conv3 has shape (?, 56, 56, 256)
resnet_v2_152/block1/unit_2/bottleneck_v2 has shape (?, 56, 56, 256)
resnet_v2_152/block1/unit_3/bottleneck_v2/conv1 has shape (?, 56, 56, 64)
resnet_v2_152/block1/unit_3/bottleneck_v2/conv2 has shape (?, 28, 28, 64)
resnet_v2_152/block1/unit_3/bottleneck_v2/conv3 has shape (?, 28, 28, 256)
resnet_v2_152/block1/unit_3/bottleneck_v2 has shape (?, 28, 28, 256)
resnet_v2_152/block1 has shape (?, 28, 28, 256)
resnet_v2_152/block2/unit_1/bottleneck_v2/shortcut has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_1/bottleneck_v2/conv1 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_1/bottleneck_v2/conv2 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_1/bottleneck_v2/conv3 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_1/bottleneck_v2 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_2/bottleneck_v2/conv1 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_2/bottleneck_v2/conv2 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_2/bottleneck_v2/conv3 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_2/bottleneck_v2 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_3/bottleneck_v2/conv1 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_3/bottleneck_v2/conv2 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_3/bottleneck_v2/conv3 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_3/bottleneck_v2 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_4/bottleneck_v2/conv1 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_4/bottleneck_v2/conv2 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_4/bottleneck_v2/conv3 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_4/bottleneck_v2 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_5/bottleneck_v2/conv1 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_5/bottleneck_v2/conv2 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_5/bottleneck_v2/conv3 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_5/bottleneck_v2 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_6/bottleneck_v2/conv1 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_6/bottleneck_v2/conv2 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_6/bottleneck_v2/conv3 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_6/bottleneck_v2 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_7/bottleneck_v2/conv1 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_7/bottleneck_v2/conv2 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_7/bottleneck_v2/conv3 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_7/bottleneck_v2 has shape (?, 28, 28, 512)
resnet_v2_152/block2/unit_8/bottleneck_v2/conv1 has shape (?, 28, 28, 128)
resnet_v2_152/block2/unit_8/bottleneck_v2/conv2 has shape (?, 14, 14, 128)
resnet_v2_152/block2/unit_8/bottleneck_v2/conv3 has shape (?, 14, 14, 512)
resnet_v2_152/block2/unit_8/bottleneck_v2 has shape (?, 14, 14, 512)
resnet_v2_152/block2 has shape (?, 14, 14, 512)
resnet_v2_152/block3/unit_1/bottleneck_v2/shortcut has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_1/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_1/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_1/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_1/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_2/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_2/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_2/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_2/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_3/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_3/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_3/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_3/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_4/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_4/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_4/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_4/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_5/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_5/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_5/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_5/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_6/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_6/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_6/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_6/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_7/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_7/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_7/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_7/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_8/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_8/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_8/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_8/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_9/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_9/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_9/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_9/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_10/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_10/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_10/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_10/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_11/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_11/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_11/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_11/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_12/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_12/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_12/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_12/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_13/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_13/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_13/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_13/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_14/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_14/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_14/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_14/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_15/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_15/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_15/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_15/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_16/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_16/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_16/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_16/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_17/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_17/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_17/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_17/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_18/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_18/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_18/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_18/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_19/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_19/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_19/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_19/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_20/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_20/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_20/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_20/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_21/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_21/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_21/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_21/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_22/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_22/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_22/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_22/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_23/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_23/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_23/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_23/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_24/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_24/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_24/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_24/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_25/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_25/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_25/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_25/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_26/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_26/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_26/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_26/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_27/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_27/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_27/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_27/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_28/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_28/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_28/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_28/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_29/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_29/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_29/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_29/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_30/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_30/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_30/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_30/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_31/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_31/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_31/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_31/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_32/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_32/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_32/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_32/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_33/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_33/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_33/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_33/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_34/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_34/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_34/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_34/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_35/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_35/bottleneck_v2/conv2 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_35/bottleneck_v2/conv3 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_35/bottleneck_v2 has shape (?, 14, 14, 1024)
resnet_v2_152/block3/unit_36/bottleneck_v2/conv1 has shape (?, 14, 14, 256)
resnet_v2_152/block3/unit_36/bottleneck_v2/conv2 has shape (?, 7, 7, 256)
resnet_v2_152/block3/unit_36/bottleneck_v2/conv3 has shape (?, 7, 7, 1024)
resnet_v2_152/block3/unit_36/bottleneck_v2 has shape (?, 7, 7, 1024)
resnet_v2_152/block3 has shape (?, 7, 7, 1024)
resnet_v2_152/block4/unit_1/bottleneck_v2/shortcut has shape (?, 7, 7, 2048)
resnet_v2_152/block4/unit_1/bottleneck_v2/conv1 has shape (?, 7, 7, 512)
resnet_v2_152/block4/unit_1/bottleneck_v2/conv2 has shape (?, 7, 7, 512)
resnet_v2_152/block4/unit_1/bottleneck_v2/conv3 has shape (?, 7, 7, 2048)
resnet_v2_152/block4/unit_1/bottleneck_v2 has shape (?, 7, 7, 2048)
resnet_v2_152/block4/unit_2/bottleneck_v2/conv1 has shape (?, 7, 7, 512)
resnet_v2_152/block4/unit_2/bottleneck_v2/conv2 has shape (?, 7, 7, 512)
resnet_v2_152/block4/unit_2/bottleneck_v2/conv3 has shape (?, 7, 7, 2048)
resnet_v2_152/block4/unit_2/bottleneck_v2 has shape (?, 7, 7, 2048)
resnet_v2_152/block4/unit_3/bottleneck_v2/conv1 has shape (?, 7, 7, 512)
resnet_v2_152/block4/unit_3/bottleneck_v2/conv2 has shape (?, 7, 7, 512)
resnet_v2_152/block4/unit_3/bottleneck_v2/conv3 has shape (?, 7, 7, 2048)
resnet_v2_152/block4/unit_3/bottleneck_v2 has shape (?, 7, 7, 2048)
resnet_v2_152/block4 has shape (?, 7, 7, 2048)
global_pool has shape (?, 1, 1, 2048)
resnet_v2_152/logits has shape (?, 1, 1, 1001)
resnet_v2_152/spatial_squeeze has shape (?, 1001)
predictions has shape (?, 1001)
Finished.
